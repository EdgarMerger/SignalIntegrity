<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="generator" content="http://www.nongnu.org/elyxer/"/>
<meta name="create-date" content="2016-06-27"/>
<link rel="stylesheet" href="http://elyxer.nongnu.org/lyx.css" type="text/css" media="all"/>
<title>PySI Help</title>
</head>
<body>
<div id="globalWrapper">
<div class="splitheader">
<span class="prev"><a class="prev" name="prev" href="PySIHelp-Subsection-10.html#next">Prev</a> Simulating</span>
<span class="up"><a class="up" name="up" href="PySIHelp-Section-6.html">Up</a> Simulation</span>
<span class="next">Deembedding <a class="next" name="next" href="PySIHelp-Section-7.html#prev">Next</a></span>
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-11"></a>Simulation Example<a class="Label" name="sub:Simulation-Example"> </a>
</h2>
<div class="Standard">
In this example, we will step through the simulation of an RLC network. this example will highlight a few things about simulation that you need to be aware of.
</div>
<div class="Standard">
The circuit we will simulate will be a series 100 nH <a class="Reference" href="PySIHelp-Subsection-41.html#sub:Inductor">Inductor↓</a>, 1 pF <a class="Reference" href="PySIHelp-Subsection-40.html#sub:Capacitor">Capacitor↓</a>, and 50 Ohm <a class="Reference" href="PySIHelp-Subsection-39.html#sub:Resistor">Resistor↓</a>. We will simulate with a step voltage applied to the input to the circuit through a <a class="Reference" href="PySIHelp-Subsection-53.html#sub:Voltage-Step-Generator">Voltage Step Generator↓</a> and probe initially the voltage at the 50 Ohm termination <a class="Reference" href="PySIHelp-Subsection-39.html#sub:Resistor">Resistor↓</a>.
</div>
<div class="Standard">
When we open PySIApp, we have a blank canvas:
</div>
<div class="Standard">
<img class="embedded" src="BlanckCanvas.png" alt="figure BlanckCanvas.png"/>

</div>
<div class="Standard">
We invoke <a class="Reference" href="PySIHelp-Subsubsection-29.html#Control-Help:Add-Part">Add Part↓</a>:
</div>
<div class="Standard">
<img class="embedded" src="PartPicker.png" alt="figure PartPicker.png"/>

</div>
<div class="Standard">
Select the Generators category, and select the One Port <a class="Reference" href="PySIHelp-Subsection-53.html#sub:Voltage-Step-Generator">Voltage Step Generator↓</a>:
</div>
<div class="Standard">
<img class="embedded" src="PartPickerOnePortVoltageGenerator.png" alt="figure PartPickerOnePortVoltageGenerator.png"/>

</div>
<div class="Standard">
For now, we accept the default properties which state that the step generator will generate a <a class="Reference" href="PySIHelp-Section-15.html#sec:Waveform">Waveform↓</a> that starts at -100 ns, runs for 200 ns (i.e. ends at 100 ns) which is 0 V until 0 s after which it jumps to 1 V for the duration.
</div>
<div class="Standard">
<img class="embedded" src="PartPropertiesVoltageStepGeneratorDefault.png" alt="figure PartPropertiesVoltageStepGeneratorDefault.png"/>

</div>
<div class="Standard">
Press OK and left-click to place the part in the schematic and drag the part to where you want it:
</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep1.png" alt="figure SimulatorExampleStep1.png"/>

</div>
<div class="Standard">
Now we use <a class="Reference" href="PySIHelp-Subsubsection-29.html#Control-Help:Add-Part">Add Part↓</a> to add an <a class="Reference" href="PySIHelp-Subsection-41.html#sub:Inductor">Inductor↓</a>:
</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep2.png" alt="figure SimulatorExampleStep2.png"/>

</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep3.png" alt="figure SimulatorExampleStep3.png"/>

</div>
<div class="Standard">
Double click in the inductance part property entry box and type 100n and hit enter:
</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep4.png" alt="figure SimulatorExampleStep4.png"/>

</div>
<div class="Standard">
Press OK, click in the schematic and hold the left mouse button down to drag the part to the desired location to the right of the voltage generator:
</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep5.png" alt="figure SimulatorExampleStep5.png"/>

</div>
<div class="Standard">
Repeat for a two-port, 1 pF <a class="Reference" href="PySIHelp-Subsection-40.html#sub:Capacitor">Capacitor↓</a> and a one-port 50 Ohm <a class="Reference" href="PySIHelp-Subsection-39.html#sub:Resistor">Resistor↓</a>.
</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep6.png" alt="figure SimulatorExampleStep6.png"/>

</div>
<div class="Standard">
Now connect all of the devices using <a class="Reference" href="PySIHelp-Subsubsection-42.html#Control-Help:Add-Wire">Add Wire↓</a> commands. We start wire drawing by invoking <a class="Reference" href="PySIHelp-Subsubsection-42.html#Control-Help:Add-Wire">Add Wire↓</a> and we observe that the cursor turns into a pen, and we see Drawing Wires in the status bar. We left click on the top of the voltage generator and see a dot form at the generator connection point. We move the mouse up a bit and we see a rubber band wire form between the top of the generator and the cursor and we left click again. A line now extends upward from the voltage generator to a dot. We move the cursor to the right to the left side of the inductor and left click again. We right click to end the wire and move to the mouse to the right side of the inductor. There is no rubber band line because we completed the drawing of the last wire, but left clicking on the right port of the inductor places another dot and begins the next wire. We move the mouse to the left side of the capacitor, observing the rubber band line, and left click. Right clicking ends that wire and we move on to the connection of the right side of the capacitor to the top of the one-port resistor to ground. When we complete this wire, we right click twice to end drawing wires. Notice that the cursor returns to an arrow and the status bar message shows nothing.
</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep7.png" alt="figure SimulatorExampleStep7.png"/>

</div>
<div class="Standard">
If you want, experiment with changing the wires by left clicking on a wire vertex and dragging:
</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep8.png" alt="figure SimulatorExampleStep8.png"/>

</div>
<div class="Standard">
or by clicking in the middle of a wire and dragging:
</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep9.png" alt="figure SimulatorExampleStep9.png"/>

</div>
<div class="Standard">
Now, use <a class="Reference" href="PySIHelp-Subsubsection-31.html#Control-Help:Add-Output-Probe">Add Output Probe↓</a> to add some probing points to the circuit. When we invoke <a class="Reference" href="PySIHelp-Subsubsection-31.html#Control-Help:Add-Output-Probe">Add Output Probe↓</a>, we see the part properties dialog for the <a class="Reference" href="PySIHelp-Subsection-61.html#sub:Output-Probe">Output Probe↓</a>:
</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep10.png" alt="figure SimulatorExampleStep10.png"/>

</div>
<div class="Standard">
Click the leftmost checkbox for the reference designator (so it shows in the schematic), and double click in the reference designator entry box and type Vin followed by the enter key:
</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep11.png" alt="figure SimulatorExampleStep11.png"/>

</div>
<div class="Standard">
Press OK and place the probe on the wire connecting the voltage source to the inductor:
</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep12.png" alt="figure SimulatorExampleStep12.png"/>

</div>
<div class="Standard">
If you want to make it look better, use <a class="Reference" href="PySIHelp-Subsubsection-40.html#Control-Help:Flip-Horizontally">Flip Horizontally↓</a> to change the orientation.
</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep13.png" alt="figure SimulatorExampleStep13.png"/>

</div>
<div class="Standard">
Use <a class="Reference" href="PySIHelp-Subsubsection-48.html#Control-Help:Pan">Pan↓</a> to pan the drawing a bit to the right.
</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep14.png" alt="figure SimulatorExampleStep14.png"/>

</div>
<div class="Standard">
Select the <a class="Reference" href="PySIHelp-Subsection-61.html#sub:Output-Probe">Output Probe↓</a> and use <a class="Reference" href="PySIHelp-Subsubsection-38.html#Control-Help:Duplicate-Part">Duplicate Part↓</a> to place another probe at the resistor. Use <a class="Reference" href="PySIHelp-Subsubsection-40.html#Control-Help:Flip-Horizontally">Flip Horizontally↓</a> to change the orientation, and <a class="Reference" href="PySIHelp-Subsubsection-37.html#Control-Help:Edit-Properties">Edit Properties↓</a> to change the reference designator to Vout.
</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep15.png" alt="figure SimulatorExampleStep15.png"/>

</div>
<div class="Standard">
Notice now that <a class="Reference" href="PySIHelp-Subsubsection-51.html#Control-Help:Calculate-Button">Calculate↓</a> and <a class="Reference" href="PySIHelp-Subsubsection-53.html#Control-Help:Simulate">Simulate↓</a> are now enabled.
</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep16.png" alt="figure SimulatorExampleStep16.png"/>

</div>
<div class="Standard">
Go ahead and invoke <a class="Reference" href="PySIHelp-Subsubsection-53.html#Control-Help:Simulate">Simulate↓</a> and let’s see what happens. After a few seconds of calculation, we see the <a class="Reference" href="PySIHelp-Section-10.html#sec:Simulator-Dialog">Simulator Dialog↓</a>.
</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep17.png" alt="figure SimulatorExampleStep17.png"/>

</div>
<div class="Standard">
Let’s zoom in on the green Vout waveform to see what happened:
</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep18.png" alt="figure SimulatorExampleStep18.png"/>

</div>
<div class="Standard">
This is, of course nonsense, so let’s understand what happened here and how the simulator works. Understand this, we need on more set of information - the <a class="Reference" href="PySIHelp-Subsubsection-49.html#Control-Help:Calculation-Properties">Calculation Properties↓</a>, where we see:
</div>
<div class="Standard">
<img class="embedded" src="CalculationPropertiesDefault.png" alt="figure CalculationPropertiesDefault.png"/>

</div>
<div class="Standard">
The simulator operates by generating transfer parameters that convert waveforms generated from sources, in this case the step generator, into the output waveforms. In this case, since we have only one source, these are essentially two filters that are applied to the source waveform, one filter converting the source to Vin, the other converting the source to Vout.
</div>
<div class="Standard">
These filters are specified with a frequency response of 400 points with 50 MHz spacing out to 20 GHz. If s-parameter files had appeared in the schematic, all s-parameters would be resampled to this specification during calculation of the transfer parameters.
</div>
<div class="Standard">
The net effect of the transfer parameters calculation is two finite-impulse response (FIR) filters whose impulse response length is 20 ns. In the accompanying book that describes the theory, we explain all about this, but suffice it to say that the filter impulse response is 20 ns long with time 0 appearing in the middle (i.e. has 10 ns of filter duration prior to time zero and 10 ns after time zero).
</div>
<div class="Standard">
Since FFT methods are utilized, and since the FFT assumes that the frequency response represents the <i>impulse train response</i> (as opposed to a single impulse response), we have an opportunity for time-aliasing effects, which we’ve certainly created. To see this, invoke <a class="Reference" href="PySIHelp-Subsubsection-14.html#Control-Help:View-Transfer-Parameters">View Transfer Parameters↓</a> from the <a class="Reference" href="PySIHelp-Section-10.html#sec:Simulator-Dialog">Simulator Dialog↓</a> and we see:
</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep19.png" alt="figure SimulatorExampleStep19.png"/>

</div>
<div class="Standard">
This is the trivial filter that converts the source waveform VG1 into Vin. this filter is, of course, a single impulse as these two are the same.
</div>
<div class="Standard">
Selecting Vout due to VG1 shows something more interesting:
</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep20.png" alt="figure SimulatorExampleStep20.png"/>

</div>
<div class="Standard">
Here we see that the filter is highly resonant, which is not surprising. We see this in the magnitude response in the upper left, to some degree from the 180 degree phase transition in the phase response in the upper right, in the impulse response in the lower left which is clearly not settled at the end, and we see the problem the most clearly from the step response in the lower right.
</div>
<div class="Standard">
Because of the FFT methods utilized, we see that the unsettled response to the right continues from the left (at negative time) and is clearly giving us the wrong answer.
</div>
<div class="Standard">
In the future, we might provide better or automated ways of dealing with this, but this is a common problem, especially when s-parameters are used, and is worth seeing and dealing with manually.
</div>
<div class="Standard">
Clearly, 20 ns worth of impulse response is insufficient. Let’s use something like 100 ns. So we edit the <a class="Reference" href="PySIHelp-Subsubsection-49.html#Control-Help:Calculation-Properties">Calculation Properties↓</a>, change the impulse response length to 100 ns, close the dialog returning to the <a class="Reference" href="PySIHelp-Section-10.html#sec:Simulator-Dialog">Simulator Dialog↓</a>, and recalculate. After adjusting the zoom a bit, we have:
</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep21.png" alt="figure SimulatorExampleStep21.png"/>

</div>
<div class="Standard">
This is clearly a much better result. You can examine the transfer parameters to see that the 100 ns impulse response did the trick.
</div>
<div class="Standard">
Examining the calculation properties we see the implications of the 100 ns impulse response:
</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep22.png" alt="figure SimulatorExampleStep22.png"/>

</div>
<div class="Standard">
It means that two thousand frequency points were required at 10 MHz spacing. If this system were provided through s-parameter measurements, this would be the frequency resolution required to get a good time-domain simulation - regardless of what kind of simulator were employed.
</div>
<div class="Standard">
As a final note, note that in the original, incorrect simulation, the waveform result was almost 200 ns long (it was 180 ns to be precise) and that the final result is 100 ns long. This is because the impulse response length is removed half from the front and half from the back of the waveform. This is explained in the accompanying book. This means that the input waveform must be sized properly to give you the result you want. If in my simulation, my desire was to see the step response starting at -10 ns until 30 ns, and understanding that the filter takes 50 ns from the front and back, we’d want an input waveform that starts at -60 ns and ends at 80 ns, for a 140 ns duration.
</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep23.png" alt="figure SimulatorExampleStep23.png"/>

</div>
<div class="Standard">
<img class="embedded" src="SimulatorExampleStep24.png" alt="figure SimulatorExampleStep24.png"/>

</div>
<div class="splitheader">
<span class="prev"><a class="prev" name="prev" href="PySIHelp-Subsection-10.html#next">Prev</a> Simulating</span>
<span class="up"><a class="up" name="up" href="PySIHelp-Section-6.html">Up</a> Simulation</span>
<span class="next">Deembedding <a class="next" name="next" href="PySIHelp-Section-7.html#prev">Next</a></span>
</div>

</div>
</body>
</html>
